from excel_load import carregar_codigos_excel
from pdf_extract import pdf_extract
from read_excel_file import preencher_planilhas
import os

planilha_caminho = r"E:\Programer\Python\Projetos\LMP\LMP_SPI_plan\Assets\Processos - SPI.xlsm"
base_path = r"E:\Programer\Python\Projetos\LMP\LMP_SPI_plan\Assets"

# Teste para ver as pastas que existem
print("Pastas que existem em base_path:")
for pasta in os.listdir(base_path):
    print(pasta)
print("-" * 50)

# Continua o seu código normal
codigos_encontrados = carregar_codigos_excel(planilha_caminho)
resultados = pdf_extract(codigos_encontrados, base_path)

for codigo, status, dados_pdf in resultados:
    print(f'{codigo} - {status}')

    if status == "PDF encontrado e dados extraídos":
        print(f"Código: {codigo}")
        print(f"Dados extraídos: {dados_pdf}")

        preencher_planilhas(planilha_caminho, dados_pdf, codigo)
